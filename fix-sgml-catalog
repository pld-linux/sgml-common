#!/bin/sh
    
# very simple script that makes CATALOG file

catalogs_dir=/usr/share/sgml/catalogs
catalog=/usr/share/sgml/CATALOG
catalog_ext="cat"

# script lists *.cat files added to catalogs_dir by rpm packages
# CATALOG file
# if *.cat file is regular file, there is "CATALOG $catalogs_dir/file.cat"
# line added
# if cat file is a symlink then it is resolved and resolved filename is added

mv -f ${catalog} ${catalog}.bak
echo "-- This file is autogenerated by $0 script --" >${catalog}
    
for plik in ${catalogs_dir}/*.${catalog_ext}; do 
    ##echo "Adding file $plik to CATALOG" >/dev/stderr
    if [ -r "$plik" ]; then
	if [ -L $plik ]; then
	    plik=`ls -l $plik | awk '{print $NF}'`
	fi
	echo "CATALOG \"$plik\"" >>${catalog}
    fi
done
chmod 644 ${catalog}
